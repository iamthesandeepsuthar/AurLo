<div class="widget-content widget-content p-3 form-grp-w-border">
    <h2> <img src="assets/img/document_pictures_white.png">KYC Document</h2>



    <form [formGroup]="frmGroup" *ngIf="this.docTypeModel">

        <ng-container formArrayName="DocumentFormField" *ngFor="let itm of this.docTypeModel;let idx=index">
            <div class="form-row" [formGroupName]="idx">
                <div class="form-group col-md-3">
                    <label>{{itm!.Name }} Number</label>


                    <input type="text" [maxlength]="itm!.DocumentNumberLength" [minlength]="itm.DocumentNumberLength" (keypress)="onCheckDocumentNumber($event,itm.Id)" class="form-control" formControlName="DocumentNumber" id="DocumentNumber" [(ngModel)]="kycModel[idx]!.Kycnumber"
                        placeholder="{{itm.Name }} Number" [ngClass]="{ 'is-invalid': this.documentFormField.controls![idx].get('DocumentNumber')!.errors
             && this.documentFormField!.controls![idx].get('DocumentNumber')!.touched}">
                    <div class="invalid-feedback" *ngIf="(this.documentFormField!.controls![idx].get('DocumentNumber')?.hasError('required') && this.documentFormField!.controls![idx].get('DocumentNumber')?.touched)">
                        Please enter {{itm!.Name }} number...! </div>

                    <div class="invalid-feedback" *ngIf="!this.documentFormField!.controls![idx].get('DocumentNumber')!.hasError('required') &&
             ((this.documentFormField!.controls![idx]!.get('DocumentNumber')!.hasError('maxlength') || this.documentFormField!.controls![idx].get('DocumentNumber')!.hasError('minlength')) &&
              this.documentFormField!.controls![idx].get('DocumentNumber')!.touched) || (this.documentFormField!.controls![idx].get('DocumentNumber')!.hasError('maxlength') || this.documentFormField!.controls![idx].get('DocumentNumber')!.hasError('minlength'))">
                        {{itm!.Name }} number length must be {{itm!.DocumentNumberLength}} char or digit...! </div>
                </div>

                <div class="form-group col-md-2">
                    <label>{{itm!.Name }} Attachment</label>
                    <input type="hidden" name="File" ngModel="{{(documentModel[idx]!.Files!.length>0) && (itm.RequiredFileCount == documentModel[idx]!.Files!.length) ? documentModel[idx]!.Files!.length :undefined}}" formControlName="File">

                    <app-file-selector (FilesChanged)="onDocumentAttach(itm.Id, $event)" [ngClass]="{ 'is-invalid':(documentFormField!.controls![idx].get('File')?.hasError('required') && documentFormField!.controls![idx].get('File')?.touched )||( documentModel[idx]!.Files!.length>0 && itm.RequiredFileCount != documentModel[idx]!.Files!.length)}"
                        [CurrentFileLength]="documentModel[idx]!.Files!.length ?? 0" [MaxFileLength]="itm.RequiredFileCount">
                    </app-file-selector>
                    {{itm.RequiredFileCount +'/'+ documentModel[idx]!.Files!.length}}


                    <div class="invalid-feedback" *ngIf="(this.documentFormField!.controls![idx].get('File')?.hasError('required') && this.documentFormField!.controls![idx].get('File')?.touched) &&  !documentModel[idx]!.Files!.length">
                        Please Add {{itm!.Name }} doc ...! </div>


                    <div class="invalid-feedback" *ngIf="this.documentFormField!.controls![idx].get('File')?.hasError('required') && documentModel[idx]!.Files!.length>0 &&  itm.RequiredFileCount != documentModel[idx]!.Files!.length">
                        Please Add anther side {{itm!.Name }} doc ...! </div>

                </div>
                <div class="col-md-4 px-3">

                    <ul class="m-0 p-0 mb-4 mb-md-0" *ngIf="documentModel!.length>0 && documentModel &&  documentModel[idx]!.DocumentTypeId > 0 ">

                        <ng-container *ngFor="let item of documentModel[idx]?.Files">

                            <div *ngIf="item.Id>0" class="dropzone dropzone-light file-upload-details">
                                <div class="dz-details">
                                    <div class="dz-filename"><span data-dz-name="">{{item?.FileName}}</span></div>
                                </div>

                                <a [href]="item.File" target="_blank">
                                    <i data-toggle="tooltip" data-placement="bottom" title="View" class="fas fa-eye file-upload-details-remove"></i>
                                </a>
                                <i (click)="removeDocFile(item,this.documentModel[idx]!.Id, itm.Id)" data-toggle="tooltip" data-placement="bottom" title="Remove" class="fas fa-trash-alt text-danger file-upload-details-remove"></i>
                            </div>



                        </ng-container>

                    </ul>
                </div>


            </div>
        </ng-container>

    </form>

</div>
